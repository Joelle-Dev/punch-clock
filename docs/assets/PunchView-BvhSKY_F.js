import{o as l,j as c,a4 as Y,r as L,i as gt,a5 as ct,c as z,w as N,a as t,F as D,l as P,a6 as lt,t as h,d as tt,B as ut,e as V,h as y,G as kt,u as Ct,a7 as bt,m as E,k as G,n as J,a8 as it,H as X,I as rt,a9 as xt,aa as At}from"./index-CWT-PhVF.js";/* empty css              */import{u as Bt}from"./useDoubleTapHint-kDL3htUs.js";import{_ as Et}from"./BaseModal-DX1XnQdX.js";import{_ as Mt}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{T as Lt,a as Dt}from"./index-DkOmAc1Z.js";import"./use-id-C3R_iJW7.js";const St=["width","height"],Tt={__name:"ToiletIcon",props:{size:{type:[Number,String],default:24}},setup(r){return(d,a)=>(l(),c("svg",{width:r.size,height:r.size,viewBox:"0 0 96 96",xmlns:"http://www.w3.org/2000/svg",style:{display:"inline-block",verticalAlign:"middle"}},[...a[0]||(a[0]=[Y('<g transform="translate(48 48) scale(1.5) translate(-48 -48)"><rect x="26" y="22" rx="6" ry="6" width="28" height="22" fill="#FFFFFF" stroke="#B8C4FF" stroke-width="2"></rect><circle cx="50" cy="28" r="2" fill="#B8C4FF"></circle><rect x="30" y="36" rx="10" ry="10" width="36" height="26" fill="#FFFFFF" stroke="#B8C4FF" stroke-width="2"></rect><ellipse cx="48" cy="50" rx="10" ry="7" fill="#D6E4FF"></ellipse><circle cx="40" cy="44" r="2" fill="#7D8FFF"></circle><circle cx="56" cy="44" r="2" fill="#7D8FFF"></circle><path d="M42 48 C 45 52, 51 52, 54 48" stroke="#FF9BB3" stroke-width="2" fill="none" stroke-linecap="round"></path><path d="M36 62 H60 L56 74 H40 Z" fill="#FFFFFF" stroke="#B8C4FF" stroke-width="2"></path><path d="M32 40 C34 36, 38 34, 42 34" stroke="#EDF1FF" stroke-width="3" fill="none" stroke-linecap="round"></path></g>',1)])],8,St))}},$t=["width","height"],zt={__name:"MealIcon",props:{size:{type:[Number,String],default:24}},setup(r){return(d,a)=>(l(),c("svg",{width:r.size,height:r.size,viewBox:"0 0 96 96",xmlns:"http://www.w3.org/2000/svg",style:{display:"inline-block",verticalAlign:"middle"}},[...a[0]||(a[0]=[Y(`<g transform="translate(48 52) scale(1.7) translate(-48 -52)"><path d="M32 54
           C 32 50, 36 46, 48 46
           C 60 46, 64 50, 64 54
           C 64 58, 60 62, 48 62
           C 36 62, 32 58, 32 54 Z" fill="#FFFFFF" stroke="#E2C39B" stroke-width="2"></path><path d="M40 62
           C 41 64, 43 66, 48 66
           C 53 66, 55 64, 56 62" fill="#FFFFFF" stroke="#E2C39B" stroke-width="2" stroke-linecap="round"></path><path d="M34 52
           C 36 46, 41 42, 48 42
           C 55 42, 60 46, 62 52
           C 58 54, 53 55.5, 48 56
           C 43 55.5, 38 54.5, 34 52 Z" fill="#FFFFFF" stroke="#F0E4D0" stroke-width="1.4"></path><path d="M40 47 C42.5 46,45 46,47.5 47" stroke="#F7EFE2" stroke-width="1.8" stroke-linecap="round"></path><path d="M49 46.8 C51.5 46,54 46,56 47.2" stroke="#F7EFE2" stroke-width="1.8" stroke-linecap="round"></path><path d="M45 51.5
           C 47.3 50.8, 49.7 50.8, 52 51.7
           C 52.4 53, 52 54.2, 50.9 55.2
           C 49 55.5, 47.5 55.2, 46 54.2
           C 45.5 53.4, 45.3 52.5, 45 51.5 Z" fill="#FFE3A3" stroke="#F2C774" stroke-width="1"></path><path d="M38 53
           C 36.5 52, 35.5 50.5, 36.3 49
           C 37.5 47.5, 39.3 47.4, 41 48.4
           C 42 50, 41.5 51.5, 40 52.8 Z" fill="#B7E08C" stroke="#8FBF63" stroke-width="1"></path><g transform="rotate(-25 60 40)"><rect x="52" y="38" width="24" height="2.6" rx="1.3" fill="#F0B15A"></rect><rect x="54" y="35.6" width="24" height="2.6" rx="1.3" fill="#F0B15A"></rect></g><circle cx="44" cy="58" r="1.3" fill="#D0834A"></circle><circle cx="52" cy="58" r="1.3" fill="#D0834A"></circle><path d="M45.5 60.5 C 47 61.8, 49 61.8, 50.5 60.5" stroke="#FF6B9D" stroke-width="1.5" fill="none" stroke-linecap="round"></path></g>`,1)])],8,$t))}},Nt=["width","height"],Pt={__name:"FitnessIcon",props:{size:{type:[Number,String],default:24}},setup(r){return(d,a)=>(l(),c("svg",{width:r.size,height:r.size,viewBox:"0 0 96 96",xmlns:"http://www.w3.org/2000/svg",style:{display:"inline-block",verticalAlign:"middle"}},[...a[0]||(a[0]=[Y(`<g transform="translate(48 48) scale(1.6) translate(-48 -48)"><g transform="translate(0, 4)"><path d="M28 54
             C 30 46, 36 40, 44 38
             C 50 36, 54 38, 56 42
             C 58 46, 56 50, 52 52
             C 48 54, 44 56, 40 58
             C 35 60, 30 60, 28 58
             Z" fill="#FFE0C2" stroke="#E2B194" stroke-width="2" stroke-linejoin="round"></path><path d="M34 50 C 40 46, 48 45, 53 48" stroke="#FFD2AE" stroke-width="2.2" fill="none" stroke-linecap="round"></path><path d="M38 56
             C 44 56, 50 54, 54 50
             C 56 48, 58 46, 60 46
             C 62 46, 64 48, 64 50
             C 64 52, 62 54, 60 55
             C 55 58, 48 60, 42 60
             C 40 60, 38 58, 38 56 Z" fill="#FFE0C2" stroke="#E2B194" stroke-width="2" stroke-linejoin="round"></path><rect x="56" y="46" width="8" height="6" rx="3" fill="#4D7CFF"></rect><path d="M60 40
             C 56 40, 54 42, 54 45
             L 54 50
             C 54 52, 56 54, 58 54
             L 62 54
             C 65 54, 68 52, 68 49
             C 68 46, 66 44, 64 44
             L 62 44
             C 62 42, 61 40, 60 40 Z" fill="#FFE0C2" stroke="#E2B194" stroke-width="2" stroke-linejoin="round"></path></g><g transform="translate(0, 0) rotate(-15 66 26)"><rect x="58" y="24" width="16" height="4" rx="2" fill="#B7C4FF"></rect><rect x="54" y="22" width="4" height="8" rx="2" fill="#8FA1FF"></rect><rect x="74" y="22" width="4" height="8" rx="2" fill="#8FA1FF"></rect></g><circle cx="50" cy="70" r="7.5" fill="#FFFFFF" stroke="#C8D0F8" stroke-width="1.5"></circle><path d="M47 68 Q48 67 49 68" stroke="#5A5A7A" stroke-width="1.4" fill="none" stroke-linecap="round"></path><path d="M51 68 Q52 67 53 68" stroke="#5A5A7A" stroke-width="1.4" fill="none" stroke-linecap="round"></path><path d="M47.5 71 C 49 72.5, 51 72.5, 52.5 71" stroke="#FF6B9D" stroke-width="1.5" fill="none" stroke-linecap="round"></path></g>`,1)])],8,Nt))}},Ut=["width","height"],Rt={__name:"OtherIcon",props:{size:{type:[Number,String],default:24}},setup(r){return(d,a)=>(l(),c("svg",{width:r.size,height:r.size,viewBox:"0 0 96 96",xmlns:"http://www.w3.org/2000/svg",style:{display:"inline-block",verticalAlign:"middle"}},[...a[0]||(a[0]=[Y('<g transform="translate(48 48) scale(1.18) translate(-48 -48)"><path d="M48 20 L52 36 L68 36 L56 46 L60 62 L48 52 L36 62 L40 46 L28 36 L44 36 Z" fill="#FFFFFF" stroke="#D4A3FF" stroke-width="2"></path><path d="M48 32 L49 40 L57 40 L51 44 L53 52 L48 48 L43 52 L45 44 L39 40 L47 40 Z" fill="#E8C5FF"></path><circle cx="44" cy="42" r="2" fill="#B47FFF"></circle><circle cx="52" cy="42" r="2" fill="#B47FFF"></circle><path d="M46 46 C 47 49, 49 49, 50 46" stroke="#FF6B9D" stroke-width="2" fill="none" stroke-linecap="round"></path><circle cx="30" cy="30" r="2" fill="#E8C5FF"></circle><circle cx="66" cy="30" r="2" fill="#E8C5FF"></circle><circle cx="30" cy="66" r="2" fill="#E8C5FF"></circle><circle cx="66" cy="66" r="2" fill="#E8C5FF"></circle></g>',1)])],8,Ut))}};function jt(r,d){const a=String(d).trim()?String(d).trim():"ç§‹ç‘¾";switch(r){case"toilet":return a+"åˆæ‹‰ç²‘ç²‘å•¦ï½";case"meal":return a+"çœŸä¹–ï¼Œåƒé¥­é¦™é¦™ï½";case"fitness":return a+"å¨æ­¦ï¼ŒèŒå£®æˆé•¿ï½";default:return a+"çœŸæ£’ï½"}}function It(){try{typeof navigator<"u"&&navigator.vibrate&&navigator.vibrate(15)}catch{}}const Ht={class:"punch-success-wave-wrap","aria-hidden":"true"},Zt={class:"punch-success-wave punch-success-wave--main"},Vt={class:"punch-success-wave punch-success-wave--mirror"},Yt={class:"punch-success-message"},M=25,Ot={__name:"PunchSuccessModal",props:{open:Boolean,message:{type:String,default:""}},emits:["update:open"],setup(r,{emit:d}){const a="./music1.mp3",U=r,S=d,R=y({get:()=>U.open,set:o=>S("update:open",o)}),_=L(Array(M).fill(.08));let T=null,F=null,x=null,v=null;function g(){if(x!=null&&(cancelAnimationFrame(x),x=null),v){try{v.disconnect()}catch{}v=null}_.value=Array(M).fill(.08)}function j(){if(!F)return;const o=new Uint8Array(F.frequencyBinCount);F.getByteFrequencyData(o);const p=M,m=Math.max(1,Math.floor(o.length/p)),i=[];for(let w=0;w<p;w++){let k=0;const A=w*m,I=Math.min(A+m,o.length);for(let C=A;C<I;C++)k+=o[C];const H=k/(I-A);i.push(Math.min(1,H/255*1.2+.08))}_.value=i,x=requestAnimationFrame(j)}async function O(){g();try{const o=T||new(window.AudioContext||window.webkitAudioContext);T=o,o.state==="suspended"&&await o.resume();const m=await(await fetch(a)).arrayBuffer(),i=await o.decodeAudioData(m);v=o.createBufferSource(),v.buffer=i,F=o.createAnalyser(),F.fftSize=256,F.smoothingTimeConstant=.7,v.connect(F),F.connect(o.destination),v.onended=()=>g(),v.start(0),j()}catch{_.value=Array(M).fill(.08)}}gt(()=>U.open,o=>{o?O():g()},{immediate:!0}),ct(g);function K(){S("update:open",!1)}return(o,p)=>{const m=ut;return l(),z(Et,{open:R.value,"onUpdate:open":p[0]||(p[0]=i=>R.value=i),"show-close":!1,"inner-class":"punch-success-modal-inner"},{default:N(()=>[p[2]||(p[2]=t("div",{class:"punch-success-header"},[t("span",{class:"punch-success-label"},"æ‰“å¡æˆåŠŸ")],-1)),t("div",Ht,[t("div",Zt,[(l(),c(D,null,P(M,i=>t("span",{key:"main-"+i,class:"wave-bar",style:lt({transform:`scaleY(${_.value[i-1]})`})},null,4)),64))]),t("div",Vt,[(l(),c(D,null,P(M,i=>t("span",{key:"mirror-"+i,class:"wave-bar wave-bar--mirror",style:lt({transform:`scaleY(${_.value[i-1]})`})},null,4)),64))])]),t("div",Yt,h(r.message),1),tt(m,{type:"primary",block:"",round:"",class:"punch-success-btn",onClick:K},{default:N(()=>[...p[1]||(p[1]=[V("å¥½å“’",-1)])]),_:1})]),_:1},8,["open"])}}},Kt=Mt(Ot,[["__scopeId","data-v-fa51bf44"]]),qt={class:"tab-panel active punch-panel"},Wt={class:"app-header"},Qt={class:"stats-row"},Gt={class:"stat-card"},Jt={class:"stat-value"},Xt={class:"stat-card"},te={class:"stat-value"},ee={class:"stat-value"},se={key:0,class:"stat-achievement-hint"},ne={class:"app-main"},ae={class:"type-section","aria-label":"é€‰æ‹©ç±»å‹"},oe={class:"type-tab-title"},le={class:"type-tab-text"},ie={class:"punch-button-inner"},re={class:"punch-icon","aria-hidden":"true"},ce={key:0,class:"last-punch"},ue={class:"last-punch-type"},de={class:"last-punch-date"},pe={key:1,class:"last-punch"},he={class:"heatmap-section","aria-label":"æœ¬æœˆæ‰“æˆ‘"},me={class:"heatmap-container"},fe={class:"heatmap-grid"},Fe={key:0,class:"heatmap-cell heatmap-cell-empty"},ve=["title"],ye="fitness",we="ç§‹ç‘¾",_e=450,Ee={__name:"PunchView",setup(r){var ot;const{records:d,todayCount:a,streak:U,lastRecord:S,addRecord:R,getMonthHeatmap:_}=kt(),{unlockedList:T,achievements:F,checkAll:x}=Ct(),{shouldSkipDueToDoubleTap:v}=Bt(),g=X("openAchievementModal",()=>{}),j=X("showAchievementToast",()=>{}),O=X("userName",L("")),K=["toilet","meal","fitness","other"],o=["æ—¥","ä¸€","äºŒ","ä¸‰","å››","äº”","å…­"],p=[{threshold:6,class:"heatmap-cell-4"},{threshold:4,class:"heatmap-cell-3"},{threshold:2,class:"heatmap-cell-2"},{threshold:1,class:"heatmap-cell-1"}],m=[{type:"toilet",label:"å¦‚å•",emoji:"ğŸš½",short:"å•",tint:"#4caf50",iconComponent:Tt},{type:"meal",label:"é¥­å¦",emoji:"ğŸš",short:"é¥­",tint:"#ff9800",iconComponent:zt},{type:"fitness",label:"å¥èº«",emoji:"ğŸ’ª",short:"èº«",tint:"#2196f3",iconComponent:Pt},{type:"other",label:"å…¶ä»–",emoji:"âœ¨",short:"å…¶",tint:"#9c27b0",iconComponent:Rt}].map(e=>({...e,tabTitle:`${e.emoji} ${e.short}`})),i=L(K.includes((ot=S.value)==null?void 0:ot.type)?S.value.type:ye),w=L(!1),k=L(!1),A=L(""),I=y(()=>new Map(F.map(e=>[e.id,e]))),H=y(()=>{var u;const e=T.value;if(!e.length)return"";const s=e[e.length-1];return((u=I.value.get(s))==null?void 0:u.title)??""}),C=y(()=>m.find(e=>e.type===i.value)||m[0]),et=y(()=>a.value===0),dt=y(()=>[`punch-button--${i.value}`,{"punch-button-bounce":w.value,"punch-button--first":et.value}]),pt=y(()=>{var e;return`${((e=C.value)==null?void 0:e.label)||""} æ‰“æˆ‘`}),$=y(()=>{if(a.value===0)return{hasRecord:!1,text:"ä»Šå¤©è¿˜æ²¡æ‰“è¿‡æˆ‘å“¦"};const e=rt().format("YYYY-MM-DD"),s=d.value.filter(f=>f.dateKey===e);if(!s.length)return{hasRecord:!1,text:"ä»Šå¤©è¿˜æ²¡æ‰“è¿‡æˆ‘å“¦"};const u=s.reduce((f,n)=>n.timestamp>f.timestamp?n:f),b=m.find(f=>f.type===(u.type||"other"));return{hasRecord:!0,typeLabel:(b==null?void 0:b.label)??"å…¶ä»–",dateDisplay:At(u.dateKey),timeDisplay:xt(u.timestamp)}}),ht=y(()=>rt()),mt=y(()=>{const e=ht.value,s=e.year(),u=e.month()+1,b=_(d.value,s,u),f=e.startOf("month"),n=f.daysInMonth(),q=f.day(),W=[];for(let B=0;B<q;B++)W.push({empty:!0});for(let B=1;B<=n;B++){const Q=`${s}-${String(u).padStart(2,"0")}-${String(B).padStart(2,"0")}`,Z=b[Q]||0,wt=Ft(Z),_t=Z?`${Q} æ‰“æˆ‘ ${Z} æ¬¡`:Q;W.push({empty:!1,count:Z,level:wt,title:_t})}return W});function ft(e){return e==="meal"?28:24}function Ft(e){const s=p.find(u=>e>=u.threshold);return(s==null?void 0:s.class)??"heatmap-cell-0"}function vt(){var e;return((e=O.value)==null?void 0:e.trim())||we}function st(){d.value=[...d.value]}function yt(){if(v(i.value))return;It();const e=vt();A.value=jt(i.value,e),k.value=!0,R(i.value),w.value=!0,requestAnimationFrame(()=>{w.value=!1,document.body.offsetHeight,w.value=!0,setTimeout(()=>{w.value=!1},_e)}),setTimeout(()=>{x(d.value).forEach(u=>j(u))},0)}function nt(){document.visibilityState==="visible"&&st()}function at(e){e.persisted&&st()}return bt(()=>{document.addEventListener("visibilitychange",nt),window.addEventListener("pageshow",at)}),ct(()=>{document.removeEventListener("visibilitychange",nt),window.removeEventListener("pageshow",at)}),(e,s)=>{const u=Dt,b=Lt,f=ut;return l(),c("div",qt,[t("header",Wt,[t("div",Qt,[t("div",Gt,[t("span",Jt,h(E(a)),1),s[3]||(s[3]=t("span",{class:"stat-label"},"ä»Šæ—¥",-1))]),t("div",Xt,[t("span",te,h(E(U)),1),s[4]||(s[4]=t("span",{class:"stat-label"},"è¿ç»­",-1))]),t("div",{class:"stat-card stat-card-achievement",onClick:s[0]||(s[0]=(...n)=>E(g)&&E(g)(...n))},[t("span",ee,h(E(T).length),1),s[5]||(s[5]=t("span",{class:"stat-label"},"æˆå°±",-1)),H.value?(l(),c("span",se,h(H.value),1)):G("",!0)])])]),t("main",ne,[t("section",ae,[tt(b,{active:i.value,"onUpdate:active":s[1]||(s[1]=n=>i.value=n),shrink:""},{default:N(()=>[(l(!0),c(D,null,P(E(m),n=>(l(),z(u,{key:n.type,name:n.type},{title:N(()=>[t("span",oe,[(l(),z(it(n.iconComponent),{size:ft(n.type)},null,8,["size"])),t("span",le,h(n.short),1)])]),_:2},1032,["name"]))),128))]),_:1},8,["active"])]),t("section",{class:J(["punch-section",{"punch-section--first":et.value}]),"aria-label":"æ‰“å¡"},[tt(f,{type:"primary",round:"",size:"large",class:J(["punch-button",dt.value]),"aria-label":pt.value,onClick:yt},{default:N(()=>[t("span",ie,[t("span",re,[C.value?(l(),z(it(C.value.iconComponent),{key:0,size:40})):G("",!0)]),s[6]||(s[6]=t("span",{class:"punch-text"},"æ‰“æˆ‘",-1))])]),_:1},8,["class","aria-label"]),$.value.hasRecord?(l(),c("p",ce,[s[7]||(s[7]=V(" ä¸Šæ¬¡æ˜¯ ",-1)),t("span",ue,h($.value.typeLabel),1),s[8]||(s[8]=V(" ï½ ",-1)),t("span",de,h($.value.dateDisplay),1),V(" "+h($.value.timeDisplay),1)])):(l(),c("p",pe,h($.value.text),1))],2),t("section",he,[s[9]||(s[9]=t("h2",{class:"heatmap-title"},"æœ¬æœˆæ‰“æˆ‘",-1)),t("div",me,[t("div",fe,[(l(),c(D,null,P(o,n=>t("span",{key:n,class:"heatmap-week-label"},h(n),1)),64)),(l(!0),c(D,null,P(mt.value,(n,q)=>(l(),c(D,{key:q},[n.empty?(l(),c("span",Fe)):(l(),c("span",{key:1,class:J(["heatmap-cell",n.level]),title:n.title},h(n.count||""),11,ve))],64))),128))])])])]),k.value?(l(),z(Kt,{key:0,open:k.value,"onUpdate:open":s[2]||(s[2]=n=>k.value=n),message:A.value},null,8,["open","message"])):G("",!0)])}}};export{Ee as default};
