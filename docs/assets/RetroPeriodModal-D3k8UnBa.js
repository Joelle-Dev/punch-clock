import{_ as O,J as R,I as l,i as U,o as F,c as I,w as v,a as j,d as r,P as A,m as c,B as H,e as J,r as f,h as d,K as D}from"./index-X1Z84OWo.js";/* empty css              */import{D as K}from"./index-BxVikA5j.js";import{F as q}from"./index-C-V46Kl7.js";import{_ as z}from"./BaseModal-CeGSKcLT.js";import{u as G}from"./useDoubleTapHint-pHmDMh-t.js";import"./use-id-BRxWW_Vv.js";const L={__name:"RetroPeriodModal",props:{open:Boolean},emits:["update:open"],setup(S,{emit:g}){const k=S,w=g,y=d({get:()=>k.open,set:t=>w("update:open",t)}),{addPeriodAt:x,formatDateDisplay:b}=R(),{shouldSkipDueToDoubleTap:C}=G({messages:["补上瘾啦？","再补要收小费啦～","手下留情嘛～"]}),_=new Date(l().subtract(2,"year").valueOf()),P=new Date(l().valueOf()),a=f(""),o=f(""),m=f(!1),p=f(!1),Y=d(()=>a.value?b(a.value):""),M=d(()=>o.value?b(o.value):""),B=d(()=>{if(!a.value)return[];const t=l(a.value);return[String(t.year()),String(t.month()+1),String(t.date())]}),h=d(()=>{if(!o.value)return[];const t=l(o.value);return[String(t.year()),String(t.month()+1),String(t.date())]}),N=d(()=>a.value?new Date(l(a.value).valueOf()):_);U(()=>k.open,t=>{t&&(a.value="",o.value="")});function T({selectedValues:t}={}){const e=t||[];if(e.length>=3){const[u,s,i]=e.map(Number);a.value=l().year(u).month(s-1).date(i).format("YYYY-MM-DD")}m.value=!1}function V({selectedValues:t}={}){const e=t||[];if(e.length>=3){const[u,s,i]=e.map(Number);o.value=l().year(u).month(s-1).date(i).format("YYYY-MM-DD")}p.value=!1}function $(){if(!C()){if(!a.value){D("选一下开始日期呀～");return}if(o.value&&o.value<a.value){D("结束日期不能早于开始日期～");return}x(a.value,o.value||null),w("update:open",!1),D("记好啦")}}return(t,e)=>{const u=q,s=K,i=A,E=H;return F(),I(z,{open:y.value,"onUpdate:open":e[6]||(e[6]=n=>y.value=n),title:"补一下～"},{default:v(()=>[e[8]||(e[8]=j("p",{class:"retro-period-hint"},"选一下忘记记的那次开始、结束日期呀～",-1)),r(u,{"model-value":Y.value,label:"开始日期",readonly:"","is-link":"",placeholder:"选择开始日期",onClick:e[0]||(e[0]=n=>m.value=!0)},null,8,["model-value"]),r(u,{"model-value":M.value,label:"结束日期",readonly:"","is-link":"",placeholder:"选填，不选表示进行中",onClick:e[1]||(e[1]=n=>p.value=!0)},null,8,["model-value"]),r(i,{show:m.value,"onUpdate:show":e[3]||(e[3]=n=>m.value=n),position:"bottom",round:""},{default:v(()=>[r(s,{"model-value":B.value,"min-date":c(_),"max-date":c(P),title:"选择开始日期",onConfirm:T,onCancel:e[2]||(e[2]=n=>m.value=!1)},null,8,["model-value","min-date","max-date"])]),_:1},8,["show"]),r(i,{show:p.value,"onUpdate:show":e[5]||(e[5]=n=>p.value=n),position:"bottom",round:""},{default:v(()=>[r(s,{"model-value":h.value,"min-date":N.value,"max-date":c(P),title:"选择结束日期",onConfirm:V,onCancel:e[4]||(e[4]=n=>p.value=!1)},null,8,["model-value","min-date","max-date"])]),_:1},8,["show"]),r(E,{type:"primary",block:"",round:"",class:"retro-period-submit",onClick:$},{default:v(()=>[...e[7]||(e[7]=[J(" 补上～ ",-1)])]),_:1})]),_:1},8,["open"])}}},oe=O(L,[["__scopeId","data-v-6a283a72"]]);export{oe as default};
