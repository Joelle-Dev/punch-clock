import{as as E,o as i,i as n,a as e,d as p,w as u,u as t,n as M,t as d,F as y,e as _,j as N,c as S,ag as b,B as Y,at as j,af as A,au as K,ad as z,av as f,aw as F,ax as H}from"./index-B6lK9Dpp.js";import{E as L}from"./index-CzZzEVAG.js";import{u as R}from"./useDoubleTapHint-S_ILrpZc.js";import"./use-id-BDOUpYTK.js";const $={class:"tab-panel active period-page"},q={class:"period-header"},G={class:"period-header-inner"},I={class:"period-main"},J={class:"period-status-badge"},O={class:"period-status-row"},Q={class:"period-status-value"},U={key:1,class:"period-status-hint"},W={class:"period-actions"},X={class:"period-prediction-card"},Z={class:"period-prediction-value"},ee={class:"period-prediction-hint"},se={key:1,class:"period-prediction-hint"},te={class:"period-history-section"},oe={class:"period-history-list"},ie={class:"period-history-content"},ae={class:"period-history-range"},ne={key:0,class:"period-history-days"},me={__name:"PeriodView",setup(re){const k=b("openConfirm",o=>{o!=null&&o.onConfirm&&confirm(o.message)&&o.onConfirm()}),C=b("openActionsMenu",()=>{}),{shouldSkipDueToDoubleTap:v}=R({messages:["记上瘾了？","手下留情～","再记要收费了～"]}),{openPeriod:r,nextPrediction:m,sortedPeriods:h,startPeriod:D,endPeriod:g,endPreviousAndStart:P,deletePeriod:B,formatDateDisplay:l}=E();function w(o){const s=F();H({title:"删掉这条？",message:"真要删掉这条呀？",showCancelButton:!0,confirmButtonText:"好哒",cancelButtonText:"算了",...s?{confirmButtonColor:s}:{}}).then(()=>B(o)).catch(()=>{})}function x(){if(v())return;const o=K();if(r.value){const s=z().subtract(1,"day").format("YYYY-MM-DD");k({title:"开始新一轮",message:"上一轮还没点「结束了」，会先帮你把上轮结束日算昨天，再记这次。确定？",onConfirm:()=>{P(s,o),f("记好啦")}})}else D(),f("记好啦")}function T(){v()||(g(),f("记好啦"))}return(o,s)=>{const c=Y,V=L;return i(),n("div",$,[e("header",q,[e("div",G,[s[1]||(s[1]=e("div",null,[e("h1",{class:"period-title"},"姨妈记"),e("p",{class:"period-subtitle"},"记一记，猜下次")],-1)),p(c,{plain:"",round:"",class:"period-header-more","aria-label":"更多操作",onClick:t(C)},{default:u(()=>[...s[0]||(s[0]=[e("span",{class:"period-header-more-icon"},"⋯",-1)])]),_:1},8,["onClick"])])]),e("main",I,[e("div",{class:M(["period-status-card",{"period-status-card--active":t(r)}])},[e("span",J,d(t(r)?"进行中":"未在经期"),1),t(r)?(i(),n(y,{key:0},[e("div",O,[s[2]||(s[2]=e("span",{class:"period-status-label"},"开始",-1)),e("span",Q,d(t(l)(t(r).startDate)),1)]),s[3]||(s[3]=e("div",{class:"period-status-row"},[e("span",{class:"period-status-label"},"结束"),e("span",{class:"period-status-value period-status-value--muted"},"尚未记录")],-1))],64)):(i(),n("p",U,"点击下方「来的第一天」开始新周期"))],2),e("div",W,[p(c,{type:"primary",round:"",block:"",class:"period-btn period-btn-start",disabled:!!t(r),onClick:x},{default:u(()=>[...s[4]||(s[4]=[_(" 来的第一天 ",-1)])]),_:1},8,["disabled"]),p(c,{plain:"",round:"",block:"",class:"period-btn period-btn-end",disabled:!t(r),onClick:T},{default:u(()=>[...s[5]||(s[5]=[_(" 结束了 ",-1)])]),_:1},8,["disabled"])]),e("div",X,[s[6]||(s[6]=e("div",{class:"period-prediction-label"},"猜你下次开始",-1)),t(m)?(i(),n(y,{key:0},[e("div",Z,d(t(l)(t(m).dateKey)),1),e("div",ee,"基于平均周期 "+d(t(m).avgCycle)+" 天，仅供参考",1)],64)):(i(),n("div",se,"再记至少 2 次「来的第一天」就有预测啦"))]),e("section",te,[s[8]||(s[8]=e("h2",{class:"period-history-title"},"记过啥",-1)),e("div",oe,[t(h).length?(i(!0),n(y,{key:0},N(t(h),a=>(i(),n("div",{key:a.id,class:"period-history-item"},[e("div",ie,[e("span",ae,d(t(l)(a.startDate))+d(a.endDate?" ～ "+t(l)(a.endDate):" ～ 进行中"),1),a.endDate?(i(),n("span",ne,d(t(j)(a.startDate,a.endDate,!0))+" 天",1)):A("",!0)]),p(c,{size:"mini",plain:"",class:"period-history-delete-btn",onClick:de=>w(a.id)},{default:u(()=>[...s[7]||(s[7]=[_("删掉",-1)])]),_:1},8,["onClick"])]))),128)):(i(),S(V,{key:1,description:"还没记过姨妈哦",image:"default",class:"period-empty"}))])])])])}}};export{me as default};
