import{o,j as d,a4 as R,i as kt,c as x,w as E,a as s,t as h,d as q,B as lt,e as N,r as g,h as m,_ as nt,G as gt,u as _t,a5 as Ct,a6 as wt,m as k,k as Y,F as z,l as K,n as O,a7 as at,H as W,I as ot,a8 as bt,a9 as xt}from"./index-CrryYXFX.js";/* empty css              */import{u as Et}from"./useDoubleTapHint-DjO1WZp3.js";import{_ as Mt}from"./BaseModal-Bm4Wp4AC.js";import{_ as Lt}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{T as At,a as Bt}from"./index-Gc-FaXHo.js";import"./use-id-Dcl2cD1E.js";const Dt=["width","height"],Tt={__name:"ToiletIcon",props:{size:{type:[Number,String],default:24}},setup(l){return(c,a)=>(o(),d("svg",{width:l.size,height:l.size,viewBox:"0 0 96 96",xmlns:"http://www.w3.org/2000/svg",style:{display:"inline-block",verticalAlign:"middle"}},[...a[0]||(a[0]=[R('<g transform="translate(48 48) scale(1.5) translate(-48 -48)"><rect x="26" y="22" rx="6" ry="6" width="28" height="22" fill="#FFFFFF" stroke="#B8C4FF" stroke-width="2"></rect><circle cx="50" cy="28" r="2" fill="#B8C4FF"></circle><rect x="30" y="36" rx="10" ry="10" width="36" height="26" fill="#FFFFFF" stroke="#B8C4FF" stroke-width="2"></rect><ellipse cx="48" cy="50" rx="10" ry="7" fill="#D6E4FF"></ellipse><circle cx="40" cy="44" r="2" fill="#7D8FFF"></circle><circle cx="56" cy="44" r="2" fill="#7D8FFF"></circle><path d="M42 48 C 45 52, 51 52, 54 48" stroke="#FF9BB3" stroke-width="2" fill="none" stroke-linecap="round"></path><path d="M36 62 H60 L56 74 H40 Z" fill="#FFFFFF" stroke="#B8C4FF" stroke-width="2"></path><path d="M32 40 C34 36, 38 34, 42 34" stroke="#EDF1FF" stroke-width="3" fill="none" stroke-linecap="round"></path></g>',1)])],8,Dt))}},St=["width","height"],$t={__name:"MealIcon",props:{size:{type:[Number,String],default:24}},setup(l){return(c,a)=>(o(),d("svg",{width:l.size,height:l.size,viewBox:"0 0 96 96",xmlns:"http://www.w3.org/2000/svg",style:{display:"inline-block",verticalAlign:"middle"}},[...a[0]||(a[0]=[R(`<g transform="translate(48 52) scale(1.7) translate(-48 -52)"><path d="M32 54
           C 32 50, 36 46, 48 46
           C 60 46, 64 50, 64 54
           C 64 58, 60 62, 48 62
           C 36 62, 32 58, 32 54 Z" fill="#FFFFFF" stroke="#E2C39B" stroke-width="2"></path><path d="M40 62
           C 41 64, 43 66, 48 66
           C 53 66, 55 64, 56 62" fill="#FFFFFF" stroke="#E2C39B" stroke-width="2" stroke-linecap="round"></path><path d="M34 52
           C 36 46, 41 42, 48 42
           C 55 42, 60 46, 62 52
           C 58 54, 53 55.5, 48 56
           C 43 55.5, 38 54.5, 34 52 Z" fill="#FFFFFF" stroke="#F0E4D0" stroke-width="1.4"></path><path d="M40 47 C42.5 46,45 46,47.5 47" stroke="#F7EFE2" stroke-width="1.8" stroke-linecap="round"></path><path d="M49 46.8 C51.5 46,54 46,56 47.2" stroke="#F7EFE2" stroke-width="1.8" stroke-linecap="round"></path><path d="M45 51.5
           C 47.3 50.8, 49.7 50.8, 52 51.7
           C 52.4 53, 52 54.2, 50.9 55.2
           C 49 55.5, 47.5 55.2, 46 54.2
           C 45.5 53.4, 45.3 52.5, 45 51.5 Z" fill="#FFE3A3" stroke="#F2C774" stroke-width="1"></path><path d="M38 53
           C 36.5 52, 35.5 50.5, 36.3 49
           C 37.5 47.5, 39.3 47.4, 41 48.4
           C 42 50, 41.5 51.5, 40 52.8 Z" fill="#B7E08C" stroke="#8FBF63" stroke-width="1"></path><g transform="rotate(-25 60 40)"><rect x="52" y="38" width="24" height="2.6" rx="1.3" fill="#F0B15A"></rect><rect x="54" y="35.6" width="24" height="2.6" rx="1.3" fill="#F0B15A"></rect></g><circle cx="44" cy="58" r="1.3" fill="#D0834A"></circle><circle cx="52" cy="58" r="1.3" fill="#D0834A"></circle><path d="M45.5 60.5 C 47 61.8, 49 61.8, 50.5 60.5" stroke="#FF6B9D" stroke-width="1.5" fill="none" stroke-linecap="round"></path></g>`,1)])],8,St))}},zt=["width","height"],Nt={__name:"FitnessIcon",props:{size:{type:[Number,String],default:24}},setup(l){return(c,a)=>(o(),d("svg",{width:l.size,height:l.size,viewBox:"0 0 96 96",xmlns:"http://www.w3.org/2000/svg",style:{display:"inline-block",verticalAlign:"middle"}},[...a[0]||(a[0]=[R(`<g transform="translate(48 48) scale(1.6) translate(-48 -48)"><g transform="translate(0, 4)"><path d="M28 54
             C 30 46, 36 40, 44 38
             C 50 36, 54 38, 56 42
             C 58 46, 56 50, 52 52
             C 48 54, 44 56, 40 58
             C 35 60, 30 60, 28 58
             Z" fill="#FFE0C2" stroke="#E2B194" stroke-width="2" stroke-linejoin="round"></path><path d="M34 50 C 40 46, 48 45, 53 48" stroke="#FFD2AE" stroke-width="2.2" fill="none" stroke-linecap="round"></path><path d="M38 56
             C 44 56, 50 54, 54 50
             C 56 48, 58 46, 60 46
             C 62 46, 64 48, 64 50
             C 64 52, 62 54, 60 55
             C 55 58, 48 60, 42 60
             C 40 60, 38 58, 38 56 Z" fill="#FFE0C2" stroke="#E2B194" stroke-width="2" stroke-linejoin="round"></path><rect x="56" y="46" width="8" height="6" rx="3" fill="#4D7CFF"></rect><path d="M60 40
             C 56 40, 54 42, 54 45
             L 54 50
             C 54 52, 56 54, 58 54
             L 62 54
             C 65 54, 68 52, 68 49
             C 68 46, 66 44, 64 44
             L 62 44
             C 62 42, 61 40, 60 40 Z" fill="#FFE0C2" stroke="#E2B194" stroke-width="2" stroke-linejoin="round"></path></g><g transform="translate(0, 0) rotate(-15 66 26)"><rect x="58" y="24" width="16" height="4" rx="2" fill="#B7C4FF"></rect><rect x="54" y="22" width="4" height="8" rx="2" fill="#8FA1FF"></rect><rect x="74" y="22" width="4" height="8" rx="2" fill="#8FA1FF"></rect></g><circle cx="50" cy="70" r="7.5" fill="#FFFFFF" stroke="#C8D0F8" stroke-width="1.5"></circle><path d="M47 68 Q48 67 49 68" stroke="#5A5A7A" stroke-width="1.4" fill="none" stroke-linecap="round"></path><path d="M51 68 Q52 67 53 68" stroke="#5A5A7A" stroke-width="1.4" fill="none" stroke-linecap="round"></path><path d="M47.5 71 C 49 72.5, 51 72.5, 52.5 71" stroke="#FF6B9D" stroke-width="1.5" fill="none" stroke-linecap="round"></path></g>`,1)])],8,zt))}},Rt=["width","height"],Pt={__name:"OtherIcon",props:{size:{type:[Number,String],default:24}},setup(l){return(c,a)=>(o(),d("svg",{width:l.size,height:l.size,viewBox:"0 0 96 96",xmlns:"http://www.w3.org/2000/svg",style:{display:"inline-block",verticalAlign:"middle"}},[...a[0]||(a[0]=[R('<g transform="translate(48 48) scale(1.18) translate(-48 -48)"><path d="M48 20 L52 36 L68 36 L56 46 L60 62 L48 52 L36 62 L40 46 L28 36 L44 36 Z" fill="#FFFFFF" stroke="#D4A3FF" stroke-width="2"></path><path d="M48 32 L49 40 L57 40 L51 44 L53 52 L48 48 L43 52 L45 44 L39 40 L47 40 Z" fill="#E8C5FF"></path><circle cx="44" cy="42" r="2" fill="#B47FFF"></circle><circle cx="52" cy="42" r="2" fill="#B47FFF"></circle><path d="M46 46 C 47 49, 49 49, 50 46" stroke="#FF6B9D" stroke-width="2" fill="none" stroke-linecap="round"></path><circle cx="30" cy="30" r="2" fill="#E8C5FF"></circle><circle cx="66" cy="30" r="2" fill="#E8C5FF"></circle><circle cx="30" cy="66" r="2" fill="#E8C5FF"></circle><circle cx="66" cy="66" r="2" fill="#E8C5FF"></circle></g>',1)])],8,Rt))}};function jt(l,c){const a=String(c).trim()?String(c).trim():"ç§‹ç‘¾";switch(l){case"toilet":return a+"åˆæ‹‰ç²‘ç²‘å•¦ï½ž";case"meal":return a+"çœŸä¹–ï¼Œåƒé¥­é¦™é¦™ï½ž";case"fitness":return a+"å¨æ­¦ï¼ŒèŒå£®æˆé•¿ï½ž";default:return a+"çœŸæ£’ï½ž"}}const It={class:"punch-success-message"},Zt={__name:"PunchSuccessModal",props:{open:Boolean,message:{type:String,default:""}},emits:["update:open"],setup(l,{emit:c}){const a=l,M=c,_=m({get:()=>a.open,set:p=>M("update:open",p)}),y=g(null),L=["â™¥","âœ¨","â˜…","â˜†","â€¢","â™¥","âœ¨","â˜…"],C=["celebrate-float","celebrate-twinkle","celebrate-rise"],A=["#ff6b9d","#e84c7a","#ffd700","#ffb347","#c2185b","#f8bbd9"];function B(){if(y.value){y.value.innerHTML="";for(let p=0;p<28;p++){const i=document.createElement("span");i.className="celebrate-item "+C[p%C.length],i.textContent=L[p%L.length],i.style.left=Math.random()*80+10+"%",i.style.top=Math.random()*80+10+"%",i.style.animationDelay=Math.random()*.8+"s",i.style.color=A[p%A.length],i.style.fontSize=12+Math.random()*12+"px",y.value.appendChild(i)}}}function P(){nt(()=>{requestAnimationFrame(()=>{nt(()=>{B(),setTimeout(B,80)})})})}function D(){M("update:open",!1)}return kt(()=>a.open,p=>{p&&P()},{immediate:!0}),(p,i)=>{const j=lt;return o(),x(Mt,{open:_.value,"onUpdate:open":i[0]||(i[0]=I=>_.value=I),"show-close":!1,"inner-class":"punch-success-modal-inner"},{default:E(()=>[s("div",{ref_key:"celebrationRef",ref:y,class:"punch-success-celebration","aria-hidden":"true"},null,512),s("div",It,h(l.message),1),q(j,{type:"primary",block:"",round:"",class:"punch-success-btn",onClick:D},{default:E(()=>[...i[1]||(i[1]=[N("å¥½å“’",-1)])]),_:1})]),_:1},8,["open"])}}},Ht=Lt(Zt,[["__scopeId","data-v-4d06afb7"]]),Ut={class:"tab-panel active punch-panel"},Vt={class:"app-header"},Yt={class:"stats-row"},Kt={class:"stat-card"},Ot={class:"stat-value"},Wt={class:"stat-card"},qt={class:"stat-value"},Qt={class:"stat-value"},Gt={key:0,class:"stat-achievement-hint"},Jt={class:"app-main"},Xt={class:"type-section","aria-label":"é€‰æ‹©ç±»åž‹"},te={class:"type-tab-title"},ee={class:"type-tab-text"},se={class:"punch-button-inner"},ne={class:"punch-icon","aria-hidden":"true"},ae={key:0,class:"last-punch"},oe={class:"last-punch-type"},le={class:"last-punch-date"},ie={key:1,class:"last-punch"},re={class:"heatmap-section","aria-label":"æœ¬æœˆæ‰“æˆ‘"},ce={class:"heatmap-container"},de={class:"heatmap-grid"},pe={key:0,class:"heatmap-cell heatmap-cell-empty"},he=["title"],ue="fitness",me="ç§‹ç‘¾",fe=450,we={__name:"PunchView",setup(l){var st;const{records:c,todayCount:a,streak:M,lastRecord:_,addRecord:y,getMonthHeatmap:L}=gt(),{unlockedList:C,achievements:A,checkAll:B}=_t(),{shouldSkipDueToDoubleTap:P}=Et(),D=W("openAchievementModal",()=>{}),p=W("showAchievementToast",()=>{}),i=W("userName",g("")),j=["toilet","meal","fitness","other"],I=["æ—¥","ä¸€","äºŒ","ä¸‰","å››","äº”","å…­"],it=[{threshold:6,class:"heatmap-cell-4"},{threshold:4,class:"heatmap-cell-3"},{threshold:2,class:"heatmap-cell-2"},{threshold:1,class:"heatmap-cell-1"}],T=[{type:"toilet",label:"å¦‚åŽ•",emoji:"ðŸš½",short:"åŽ•",tint:"#4caf50",iconComponent:Tt},{type:"meal",label:"é¥­å¦",emoji:"ðŸš",short:"é¥­",tint:"#ff9800",iconComponent:$t},{type:"fitness",label:"å¥èº«",emoji:"ðŸ’ª",short:"èº«",tint:"#2196f3",iconComponent:Nt},{type:"other",label:"å…¶ä»–",emoji:"âœ¨",short:"å…¶",tint:"#9c27b0",iconComponent:Pt}].map(t=>({...t,tabTitle:`${t.emoji} ${t.short}`})),f=g(j.includes((st=_.value)==null?void 0:st.type)?_.value.type:ue),w=g(!1),S=g(!1),Q=g(""),rt=m(()=>new Map(A.map(t=>[t.id,t]))),G=m(()=>{var r;const t=C.value;if(!t.length)return"";const e=t[t.length-1];return((r=rt.value.get(e))==null?void 0:r.title)??""}),Z=m(()=>T.find(t=>t.type===f.value)||T[0]),J=m(()=>a.value===0),ct=m(()=>[`punch-button--${f.value}`,{"punch-button-bounce":w.value,"punch-button--first":J.value}]),dt=m(()=>{var t;return`${((t=Z.value)==null?void 0:t.label)||""} æ‰“æˆ‘`}),b=m(()=>{if(a.value===0)return{hasRecord:!1,text:"ä»Šå¤©è¿˜æ²¡æ‰“è¿‡æˆ‘å“¦"};const t=ot().format("YYYY-MM-DD"),e=c.value.filter(u=>u.dateKey===t);if(!e.length)return{hasRecord:!1,text:"ä»Šå¤©è¿˜æ²¡æ‰“è¿‡æˆ‘å“¦"};const r=e.reduce((u,n)=>n.timestamp>u.timestamp?n:u),F=T.find(u=>u.type===(r.type||"other"));return{hasRecord:!0,typeLabel:(F==null?void 0:F.label)??"å…¶ä»–",dateDisplay:xt(r.dateKey),timeDisplay:bt(r.timestamp)}}),pt=m(()=>ot()),ht=m(()=>{const t=pt.value,e=t.year(),r=t.month()+1,F=L(c.value,e,r),u=t.startOf("month"),n=u.daysInMonth(),H=u.day(),U=[];for(let v=0;v<H;v++)U.push({empty:!0});for(let v=1;v<=n;v++){const V=`${e}-${String(r).padStart(2,"0")}-${String(v).padStart(2,"0")}`,$=F[V]||0,yt=mt($),vt=$?`${V} æ‰“æˆ‘ ${$} æ¬¡`:V;U.push({empty:!1,count:$,level:yt,title:vt})}return U});function ut(t){return t==="meal"?28:24}function mt(t){const e=it.find(r=>t>=r.threshold);return(e==null?void 0:e.class)??"heatmap-cell-0"}function ft(){var t;return((t=i.value)==null?void 0:t.trim())||me}function X(){c.value=[...c.value]}function Ft(){if(P(f.value))return;const t=ft();Q.value=jt(f.value,t),S.value=!0,y(f.value),w.value=!0,requestAnimationFrame(()=>{w.value=!1,document.body.offsetHeight,w.value=!0,setTimeout(()=>{w.value=!1},fe)}),setTimeout(()=>{B(c.value).forEach(r=>p(r))},0)}function tt(){document.visibilityState==="visible"&&X()}function et(t){t.persisted&&X()}return Ct(()=>{document.addEventListener("visibilitychange",tt),window.addEventListener("pageshow",et)}),wt(()=>{document.removeEventListener("visibilitychange",tt),window.removeEventListener("pageshow",et)}),(t,e)=>{const r=Bt,F=At,u=lt;return o(),d("div",Ut,[s("header",Vt,[s("div",Yt,[s("div",Kt,[s("span",Ot,h(k(a)),1),e[3]||(e[3]=s("span",{class:"stat-label"},"ä»Šæ—¥",-1))]),s("div",Wt,[s("span",qt,h(k(M)),1),e[4]||(e[4]=s("span",{class:"stat-label"},"è¿žç»­",-1))]),s("div",{class:"stat-card stat-card-achievement",onClick:e[0]||(e[0]=(...n)=>k(D)&&k(D)(...n))},[s("span",Qt,h(k(C).length),1),e[5]||(e[5]=s("span",{class:"stat-label"},"æˆå°±",-1)),G.value?(o(),d("span",Gt,h(G.value),1)):Y("",!0)])])]),s("main",Jt,[s("section",Xt,[q(F,{active:f.value,"onUpdate:active":e[1]||(e[1]=n=>f.value=n),shrink:""},{default:E(()=>[(o(!0),d(z,null,K(k(T),n=>(o(),x(r,{key:n.type,name:n.type},{title:E(()=>[s("span",te,[(o(),x(at(n.iconComponent),{size:ut(n.type)},null,8,["size"])),s("span",ee,h(n.short),1)])]),_:2},1032,["name"]))),128))]),_:1},8,["active"])]),s("section",{class:O(["punch-section",{"punch-section--first":J.value}]),"aria-label":"æ‰“å¡"},[q(u,{type:"primary",round:"",size:"large",class:O(["punch-button",ct.value]),"aria-label":dt.value,onClick:Ft},{default:E(()=>[s("span",se,[s("span",ne,[Z.value?(o(),x(at(Z.value.iconComponent),{key:0,size:40})):Y("",!0)]),e[6]||(e[6]=s("span",{class:"punch-text"},"æ‰“æˆ‘",-1))])]),_:1},8,["class","aria-label"]),b.value.hasRecord?(o(),d("p",ae,[e[7]||(e[7]=N(" ä¸Šæ¬¡æ˜¯ ",-1)),s("span",oe,h(b.value.typeLabel),1),e[8]||(e[8]=N(" ï½ž ",-1)),s("span",le,h(b.value.dateDisplay),1),N(" "+h(b.value.timeDisplay),1)])):(o(),d("p",ie,h(b.value.text),1))],2),s("section",re,[e[9]||(e[9]=s("h2",{class:"heatmap-title"},"æœ¬æœˆæ‰“æˆ‘",-1)),s("div",ce,[s("div",de,[(o(),d(z,null,K(I,n=>s("span",{key:n,class:"heatmap-week-label"},h(n),1)),64)),(o(!0),d(z,null,K(ht.value,(n,H)=>(o(),d(z,{key:H},[n.empty?(o(),d("span",pe)):(o(),d("span",{key:1,class:O(["heatmap-cell",n.level]),title:n.title},h(n.count||""),11,he))],64))),128))])])])]),S.value?(o(),x(Ht,{key:0,open:S.value,"onUpdate:open":e[2]||(e[2]=n=>S.value=n),message:Q.value},null,8,["open","message"])):Y("",!0)])}}};export{we as default};
