import{J as K,o as a,j as d,a as e,d as u,w as c,m as t,n as M,t as l,F as _,e as v,l as N,c as b,H as k,B as Y,aj as A,k as F,ak as H,I as q,K as y,al as z,am as I}from"./index-X1Z84OWo.js";import{E as J,S as L}from"./index-PU5M7Uio.js";import{u as R}from"./useDoubleTapHint-pHmDMh-t.js";import"./use-id-BRxWW_Vv.js";const G={class:"tab-panel active period-page"},O={class:"period-header"},Q={class:"period-header-inner"},U={class:"period-main"},W={class:"period-status-badge"},X={class:"period-status-row"},Z={class:"period-status-value"},$={key:1,class:"period-status-hint"},ee={class:"period-actions"},se={class:"period-prediction-card"},te={class:"period-prediction-value"},oe={class:"period-prediction-hint"},ie={key:1,class:"period-prediction-hint"},ae={class:"period-history-section"},re={class:"period-history-list"},ne={class:"period-history-item"},de={class:"period-history-content"},le={class:"period-history-range"},ce={key:0,class:"period-history-days"},fe={__name:"PeriodView",setup(pe){const C=k("openConfirm",o=>{o!=null&&o.onConfirm&&confirm(o.message)&&o.onConfirm()}),g=k("openActionsMenu",()=>{}),{shouldSkipDueToDoubleTap:f}=R({messages:["记上瘾了？","手下留情～","再记要收费了～"]}),{openPeriod:r,nextPrediction:m,sortedPeriods:h,startPeriod:D,endPeriod:w,endPreviousAndStart:B,deletePeriod:P,formatDateDisplay:p}=K();function x({position:o,name:s}){if(o!=="right")return!0;const n=z();return I({title:"删掉这条？",message:"真要删掉这条呀？",showCancelButton:!0,confirmButtonText:"好哒",cancelButtonText:"算了",...n?{confirmButtonColor:n}:{}}).then(()=>(P(s),!0)).catch(()=>!0)}function S(){if(f())return;const o=H();if(r.value){const s=q().subtract(1,"day").format("YYYY-MM-DD");C({title:"开始新一轮",message:"上一轮还没点「结束了」，会先帮你把上轮结束日算昨天，再记这次。确定？",onConfirm:()=>{B(s,o),y("记好啦")}})}else D(),y("记好啦")}function T(){f()||(w(),y("记好啦"))}return(o,s)=>{const n=Y,V=L,j=J;return a(),d("div",G,[e("header",O,[e("div",Q,[s[1]||(s[1]=e("div",null,[e("h1",{class:"period-title"},"姨妈记"),e("p",{class:"period-subtitle"},"记一记，猜下次")],-1)),u(n,{plain:"",round:"",class:"period-header-more","aria-label":"更多操作",onClick:t(g)},{default:c(()=>[...s[0]||(s[0]=[e("span",{class:"period-header-more-icon"},"⋯",-1)])]),_:1},8,["onClick"])])]),e("main",U,[e("div",{class:M(["period-status-card",{"period-status-card--active":t(r)}])},[e("span",W,l(t(r)?"进行中":"未在经期"),1),t(r)?(a(),d(_,{key:0},[e("div",X,[s[2]||(s[2]=e("span",{class:"period-status-label"},"开始",-1)),e("span",Z,l(t(p)(t(r).startDate)),1)]),s[3]||(s[3]=e("div",{class:"period-status-row"},[e("span",{class:"period-status-label"},"结束"),e("span",{class:"period-status-value period-status-value--muted"},"尚未记录")],-1))],64)):(a(),d("p",$,"点击下方「来的第一天」开始新周期"))],2),e("div",ee,[u(n,{type:"primary",round:"",block:"",class:"period-btn period-btn-start",disabled:!!t(r),onClick:S},{default:c(()=>[...s[4]||(s[4]=[v(" 来的第一天 ",-1)])]),_:1},8,["disabled"]),u(n,{plain:"",round:"",block:"",class:"period-btn period-btn-end",disabled:!t(r),onClick:T},{default:c(()=>[...s[5]||(s[5]=[v(" 结束了 ",-1)])]),_:1},8,["disabled"])]),e("div",se,[s[6]||(s[6]=e("div",{class:"period-prediction-label"},"猜你下次开始",-1)),t(m)?(a(),d(_,{key:0},[e("div",te,l(t(p)(t(m).dateKey)),1),e("div",oe,"基于平均周期 "+l(t(m).avgCycle)+" 天，仅供参考",1)],64)):(a(),d("div",ie,"再记至少 2 次「来的第一天」就有预测啦"))]),e("section",ae,[s[8]||(s[8]=e("h2",{class:"period-history-title"},"记过啥",-1)),e("div",re,[t(h).length?(a(!0),d(_,{key:0},N(t(h),i=>(a(),b(V,{key:i.id,name:i.id,"before-close":E=>x(E,i.id),class:"period-swipe-cell"},{right:c(()=>[u(n,{square:"",type:"danger",text:"删除",class:"period-swipe-delete"})]),default:c(()=>[e("div",ne,[e("div",de,[e("span",le,l(t(p)(i.startDate))+l(i.endDate?" ～ "+t(p)(i.endDate):" ～ 进行中"),1),i.endDate?(a(),d("span",ce,l(t(A)(i.startDate,i.endDate,!0))+" 天",1)):F("",!0)])])]),_:2},1032,["name","before-close"]))),128)):(a(),b(j,{key:1,image:"default",class:"period-empty"},{description:c(()=>[...s[7]||(s[7]=[e("p",{class:"period-empty-desc"},"还没记过姨妈哦",-1),e("p",{class:"period-empty-warm"},"记一次就会在这里出现～",-1)])]),_:1}))])])])])}}};export{fe as default};
