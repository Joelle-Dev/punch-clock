import{at as V,o as i,i as n,a as e,d as p,w as u,u as t,n as E,t as r,F as y,e as _,j as M,c as N,ag as v,B as Y,au as j,af as A,av as K,ad as S,aw as T,ax as z}from"./index-B9lxshWK.js";import{E as F}from"./index-DCTqO19i.js";import"./use-id-DYUp4Y_S.js";const L={class:"tab-panel active period-page"},R={class:"period-header"},$={class:"period-header-inner"},q={class:"period-main"},G={class:"period-status-badge"},H={class:"period-status-row"},I={class:"period-status-value"},J={key:1,class:"period-status-hint"},O={class:"period-actions"},Q={class:"period-prediction-card"},U={class:"period-prediction-value"},W={class:"period-prediction-hint"},X={key:1,class:"period-prediction-hint"},Z={class:"period-history-section"},ee={class:"period-history-list"},se={class:"period-history-content"},te={class:"period-history-range"},oe={key:0,class:"period-history-days"},le={__name:"PeriodView",setup(ie){const h=v("openConfirm",o=>{o!=null&&o.onConfirm&&confirm(o.message)&&o.onConfirm()}),b=v("openActionsMenu",()=>{}),{openPeriod:d,nextPrediction:m,sortedPeriods:f,startPeriod:k,endPeriod:C,endPreviousAndStart:D,deletePeriod:g,formatDateDisplay:l}=V();function P(o){const s=T();z({title:"删掉这条？",message:"真要删掉这条呀？",showCancelButton:!0,confirmButtonText:"好哒",cancelButtonText:"算了",...s?{confirmButtonColor:s}:{}}).then(()=>g(o)).catch(()=>{})}function B(){const o=K();if(d.value){const s=S().subtract(1,"day").format("YYYY-MM-DD");h({title:"开始新一轮",message:"上一轮还没点「结束了」，会先帮你把上轮结束日算昨天，再记这次。确定？",onConfirm:()=>D(s,o)})}else k()}function w(){C()}return(o,s)=>{const c=Y,x=F;return i(),n("div",L,[e("header",R,[e("div",$,[s[1]||(s[1]=e("div",null,[e("h1",{class:"period-title"},"姨妈记"),e("p",{class:"period-subtitle"},"记一记，猜下次")],-1)),p(c,{plain:"",round:"",class:"period-header-more","aria-label":"更多操作",onClick:t(b)},{default:u(()=>[...s[0]||(s[0]=[e("span",{class:"period-header-more-icon"},"⋯",-1)])]),_:1},8,["onClick"])])]),e("main",q,[e("div",{class:E(["period-status-card",{"period-status-card--active":t(d)}])},[e("span",G,r(t(d)?"进行中":"未在经期"),1),t(d)?(i(),n(y,{key:0},[e("div",H,[s[2]||(s[2]=e("span",{class:"period-status-label"},"开始",-1)),e("span",I,r(t(l)(t(d).startDate)),1)]),s[3]||(s[3]=e("div",{class:"period-status-row"},[e("span",{class:"period-status-label"},"结束"),e("span",{class:"period-status-value period-status-value--muted"},"尚未记录")],-1))],64)):(i(),n("p",J,"点击下方「来的第一天」开始新周期"))],2),e("div",O,[p(c,{type:"primary",round:"",block:"",class:"period-btn period-btn-start",disabled:!!t(d),onClick:B},{default:u(()=>[...s[4]||(s[4]=[_(" 来的第一天 ",-1)])]),_:1},8,["disabled"]),p(c,{plain:"",round:"",block:"",class:"period-btn period-btn-end",disabled:!t(d),onClick:w},{default:u(()=>[...s[5]||(s[5]=[_(" 结束了 ",-1)])]),_:1},8,["disabled"])]),e("div",Q,[s[6]||(s[6]=e("div",{class:"period-prediction-label"},"猜你下次开始",-1)),t(m)?(i(),n(y,{key:0},[e("div",U,r(t(l)(t(m).dateKey)),1),e("div",W,"基于平均周期 "+r(t(m).avgCycle)+" 天，仅供参考",1)],64)):(i(),n("div",X,"再记至少 2 次「来的第一天」就有预测啦"))]),e("section",Z,[s[8]||(s[8]=e("h2",{class:"period-history-title"},"记过啥",-1)),e("div",ee,[t(f).length?(i(!0),n(y,{key:0},M(t(f),a=>(i(),n("div",{key:a.id,class:"period-history-item"},[e("div",se,[e("span",te,r(t(l)(a.startDate))+r(a.endDate?" ～ "+t(l)(a.endDate):" ～ 进行中"),1),a.endDate?(i(),n("span",oe,r(t(j)(a.startDate,a.endDate,!0))+" 天",1)):A("",!0)]),p(c,{size:"mini",plain:"",class:"period-history-delete-btn",onClick:ae=>P(a.id)},{default:u(()=>[...s[7]||(s[7]=[_("删掉",-1)])]),_:1},8,["onClick"])]))),128)):(i(),N(x,{key:1,description:"还没记过姨妈哦",image:"default",class:"period-empty"}))])])])])}}};export{le as default};
